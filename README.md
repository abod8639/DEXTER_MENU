
////////////////////////////////////////////////////////

const unsigned char aq  [] PROGMEM = {
	// 'PAGE 8 _ ZOMBIE BIRTHDAY PRINTABLES BOTTLE LABELS - ZOMBIE LABELS (2), 84x48px
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0f, 0x9e, 0x66, 0xcb, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x0f, 0xb7, 0x6c, 0xdb, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 
	0x33, 0x3c, 0xd9, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x33, 0x30, 0xd8, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x33, 0x18, 0xd8, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x02, 0x33, 0x3c, 0xd9, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x33, 0x6c, 0xd9, 0x80, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x3e, 0x66, 0xdf, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x0c, 0x00, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xcc, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x02, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x04, 0x00, 
	0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x04, 0x00, 0x20, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x08, 0x00, 0x20, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0a, 
	0x00, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0f, 0xc0, 0x10, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x13, 0xc0, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x10, 0x08, 0x20, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10, 0xb0, 0x20, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x50, 0x88, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x13, 0x98, 0xf0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xd1, 0x1f, 0xc0, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x87, 0x30, 0x90, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0xa0, 0x22, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xe2, 0x68, 0xd0, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1f, 0xe3, 0xb0, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x9c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x7e, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0b, 0x8c, 0xc0, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x0e, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x98, 
	0x00, 0xd0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xb0, 0x00, 0x70, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x60, 0x00, 0x30, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x26, 0x6e, 0x3c, 0xff, 0xe0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x36, 0x6e, 0x66, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x37, 0x4a, 0x60, 0x33, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x37, 0xdb, 0x38, 0x33, 0xe0, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x15, 0xdb, 0x1c, 0x33, 0xe0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x15, 0x5f, 0x06, 0x33, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x19, 0x17, 0x66, 0x33, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x19, 0xb1, 0xbe, 0x33, 0xe0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
};

const unsigned char DNR [] PROGMEM = {
// 'Señal riesgo eléctrico', 84x48px
	0x00, 0x00, 0x00, 0x00, 0x00, 0x70, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0xf8, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0xf8, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0xfc, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x03, 0xde, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x8e, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x07, 0x8f, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x0f, 0x07, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0e, 0x07, 0x80, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1e, 0x03, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x1c, 0x01, 0xc0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3c, 0x01, 0xe0, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x39, 0xfc, 0xe0, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x79, 0xfc, 0xf0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xf1, 0xf8, 
	0x70, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xe3, 0xf8, 0x78, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x01, 0xe3, 0xf0, 0x38, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0xc3, 
	0xf0, 0x3c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0xc3, 0xe0, 0x1e, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x07, 0x87, 0xe0, 0x0e, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x07, 
	0x07, 0xe0, 0x0f, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0f, 0x07, 0xc0, 0x07, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x0e, 0x0f, 0xc0, 0x07, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x1e, 0x0f, 0x80, 0x03, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1c, 0x0f, 0x87, 0x01, 0xc0, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3c, 0x1f, 0x9f, 0x01, 0xe0, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x78, 0x1f, 0xfe, 0x00, 0xe0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x70, 0x1f, 0xfe, 0x00, 
	0xf0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xf0, 0x1f, 0xfe, 0x00, 0x70, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0xe0, 0x3f, 0xfe, 0x00, 0x78, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0xe0, 0x3f, 0xfe, 
	0x00, 0x3c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0xc0, 0x3f, 0x1c, 0x00, 0x3c, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x03, 0x80, 0x7c, 0x1c, 0x00, 0x1e, 0x00, 0x00, 0x00, 0x00, 0x00, 0x07, 0x80, 0x60, 
	0x1c, 0x00, 0x0e, 0x00, 0x00, 0x00, 0x00, 0x00, 0x07, 0x00, 0x00, 0x1c, 0x00, 0x0f, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x0f, 0x00, 0x00, 0x18, 0x00, 0x07, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0e, 0x00, 
	0x00, 0x18, 0x00, 0x07, 0x80, 0x00, 0x00, 0x00, 0x00, 0x1e, 0x00, 0x00, 0x58, 0x00, 0x03, 0xc0, 
	0x00, 0x00, 0x00, 0x00, 0x3c, 0x00, 0x00, 0x7c, 0x00, 0x03, 0xc0, 0x00, 0x00, 0x00, 0x00, 0x38, 
	0x00, 0x00, 0x7c, 0x00, 0x01, 0xe0, 0x00, 0x00, 0x00, 0x00, 0x78, 0x00, 0x00, 0x38, 0x00, 0x00, 
	0xe0, 0x00, 0x00, 0x00, 0x00, 0x70, 0x00, 0x00, 0x30, 0x00, 0x00, 0xf0, 0x00, 0x00, 0x00, 0x00, 
	0xf0, 0x00, 0x00, 0x30, 0x00, 0x00, 0x78, 0x00, 0x00, 0x00, 0x00, 0xe0, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x78, 0x00, 0x00, 0x00, 0x01, 0xe0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x38, 0x00, 0x00, 0x00, 
	0x01, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xf8, 0x00, 0x00, 0x00, 0x01, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xf8, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xf0, 0x00, 0x00
};

////////////////////////////////////////////////////////

#include <SPI.h>
#include <Adafruit_GFX.h>
#include <Adafruit_PCD8544.h>
#include <ClickEncoder.h>
#include <TimerOne.h>

#define SHAPE_SIZE     650 //    3D cube SIZE
#define ROTATION_SPEED 20  //    3D cube SPEED
#define DISPLAY_WIDTH  84
#define DISPLAY_HEIGHT 48

/////////////HC_SR04//////////////
short int  trigPin  = 7;    // Trigger
short int  echoPin  = 6;    // Echo
short int  max_ring = 450; //cm
long duration, cm, inches;
/////////////HC_SR04//////////////

/////////////menu/////////////////
short int menuitem     = 1;
short int frame        = 1;
short int page         = 1;
short int lastMenuItem = 1;

String menuItem1  = "TIMER";
String menuItem2  = "3D cube";
String menuItem3  = "MOOD";
String menuItem4  = "Rotate";
String menuItem5  = "Wheel";
String menuItem6  = "Image";
String menuItem7  = "HC=SR04";
String menuItem8  = "Reset";
String menuItem9  = "Light:: OFF";
String menuItem10 = "LESAR:: OFF";


short int rotated  = 4;
short int contrast = 0;
short int volume   = 0;

boolean backlight  ;
boolean LESAR  ;

String MOOD[7]     = { "  YoY", "   _<", "  ToT","  O_O", "  :)" , "  :()","  :("};
short int selectedMOOD   = 0;

String rotate[4]   = { "1" ,"2" ,"3" ,"4" };
short int selectedrotate = 0;

//////////////////////////////////
boolean up     = false;
boolean down   = false;
boolean middle = false;

ClickEncoder * encoder;
int16_t last, value;
/////////////menu/////////////////

void(* resetFunc) (void) = 0;


Adafruit_PCD8544 display = Adafruit_PCD8544( 9, 13, 12, 11, 10); 

/////////////////////////////////3d_cube////////////////////////////
float d = 3;
float px []  = { -d,  d,  d, -d, -d,  d,  d, -d };
float py []  = { -d, -d,  d,  d, -d, -d,  d,  d };
float pz []  = { -d, -d, -d, -d,  d,  d,  d,  d };
float p2x[]  = {  0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 };
float p2y[]  = {  0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 };
float r  []  = {  0 , 0 , 0 };
/////////////////////////////////3d_cube/////////////////////////////

/////////////////////////////////time////////////////////////////////
const    long time1 = 0 ;
unsigned long timeHCSR04     = 200 ;
const    long time2 = 0 ;
unsigned long timeEncoder    = 10 ;
const    long time3 = 0 ;
unsigned long timeCube       = 20 ; // Delay in ms between cube redraws
const    long time4 = 0 ;
unsigned long timeHCSR04ms2  = 2 ;
const    long time5 = 0 ;
unsigned long timeHCSR04ms10 = 10 ;
const    long time6 = 0 ;
unsigned long timeWheel      = 10 ;

unsigned long timeMillis  = millis();
/////////////////////////////////time////////////////////////////////

/////////////////////////////////wheel///////////////////////////////
short int Pos   = 0; 
short int State;
short int LastState ;  

const float pi = 3.14;
const float R  = 3.25;
const float N  = 50.50;
float distance = 0;
/////////////////////////////////wheel///////////////////////////////

 void setup()
 {

  display.begin();
  imege2();
  delay(2000);
  display.clearDisplay();

 
  pinMode(8,OUTPUT);
  pinMode(trigPin, OUTPUT);
  pinMode(echoPin, INPUT);
  
  last = encoder -> getValue();
  encoder = new ClickEncoder(A0, A1 , A2);
  encoder -> setAccelerationEnabled(false);
  Timer1.initialize(300);
  Timer1.attachInterrupt(timerIsr); 
  display.clearDisplay(); 
  setContrast();  

  display.setContrast(60); // you might have a slightly different display so it might not be the optimal value for you
  display.setRotation(4);  // rotate 90 degrees counter clockwise, can also use values of 2 and 3 to go further.
  display.display();

 }

 ///////////////////////setup/////////////////////////

 void loop() {

  drawMenu();
  readRotaryEncoder();


                ClickEncoder::Button b = encoder -> getButton();

       if (b != ClickEncoder::Open) {
       switch (b) {
      case      ClickEncoder::Clicked:
         middle = true;
      break;
    } 
  }    
  
      if (up && page == 1 ) 
      {
       up = false;

      if( menuitem == 2  && frame  == 2 ) { frame--; }
      if( menuitem == 3  && frame  == 3 ) { frame--; }
      if( menuitem == 4  && frame  == 4 ) { frame--; }
      if( menuitem == 5  && frame  == 5 ) { frame--; }
      if( menuitem == 6  && frame  == 6 ) { frame--; }
      if( menuitem == 7  && frame  == 7 ) { frame--; }
      if( menuitem == 8  && frame  == 8 ) { frame--; }
      if( menuitem == 9  && frame  == 9 ) { frame--; }
      if( menuitem == 10 && frame  == 10) { frame--; }

    lastMenuItem = menuitem ;
                   menuitem -- ;

      if (menuitem == 0) { menuitem = 1; } 

    }

  else if (up && page == 2 && menuitem == 1 ) 
  {
    up = false ;
    contrast -- ;
    setContrast();
  }

  else if (up && page == 2 && menuitem == 2 ) 
  {
    up = false;
    volume -- ;
  }
 
  else if (up && page == 2 && menuitem == 5 ) 
  {
    up = false;
    distance -- ;
    Pos -- ;
  }

  else if (up && page == 2 && menuitem == 3 ) 
  {
    up = false;
       selectedMOOD -- ;
    if(selectedMOOD == -1)   {   selectedMOOD = 2;  }
  }

  else if (up && page == 2 && menuitem == 4 ) 
  {
       up = false;
          selectedrotate -- ;
       if(selectedrotate == -1) {  selectedrotate = 1; } 
  }


    if (down && page == 1) //We have turned the Rotary Encoder Clockwise
  {

    down = false;

       if(menuitem == 3 && lastMenuItem == 2 )               { frame ++; }
 else  if(menuitem == 4 && lastMenuItem == 3 )               { frame ++; }
 else  if(menuitem == 5 && lastMenuItem == 4 )               { frame ++; }
 else  if(menuitem == 6 && lastMenuItem == 5 )               { frame ++; }
 else  if(menuitem == 7 && lastMenuItem == 6 )               { frame ++; }    
 else  if(menuitem == 8 && lastMenuItem == 7 )               { frame ++; }    
 else  if(menuitem == 9 && lastMenuItem == 8   && frame!=9 ) { frame ++; }

lastMenuItem = menuitem ;
               menuitem ++;  

       if (menuitem == 11 ){ menuitem -- ; }// 
  }
  else if (down && page == 2 &&  menuitem == 1 ) 
  {
    down = false;
    contrast ++ ;
    setContrast();
  }
 
  else if (down && page == 2 &&  menuitem == 2 ) 
  {
    down = false;
    volume ++ ;
  }
 
  else if (down && page == 2 &&  menuitem == 5 ) 
  {
    down = false;
    distance ++ ;
    Pos ++ ;
  }

  else if (down && page == 2 &&  menuitem == 3 ) 
   {
    down = false;
    selectedMOOD ++;

    if(selectedMOOD == 7)    { selectedMOOD = 0;  }
   }
  else if (down && page == 2 &&  menuitem == 4 ) 
   {
    down = false;
    selectedrotate++;

    if(selectedrotate == 4) { selectedrotate = 0; }
   }


//////////////////////////////////////////////////////////////////////////////////

    if (middle) //Middle Button is Pressed 
  {
    middle = false;

    if (page == 1 && menuitem == 9) // Backlight Control 
    {
      if (backlight) 
      {
        menuItem9 = "Light: OFF";
        digitalWrite(8,LOW);
        backlight = false;
      }
      else 
      {
        menuItem9 = "Light: ON";
        digitalWrite(8,HIGH);
        backlight = true; 
      }
    }/////////////////Backlight Control////////////

    if (page == 1 && menuitem == 10) // Backlight Control 
    {
      if (LESAR) 
      {
        menuItem10 = "LESAR: OFF";
        digitalWrite(5,LOW);
        LESAR = false ; 

      }
      else 
      {
        menuItem10 = "LESAR: ON";
        digitalWrite(5,HIGH);
        LESAR = true ;
      }
    }/////////////////LESAR Control////////////


    else if ( page == 1 && menuitem <= 7 ) { page = 2 ; }

    else if ( page == 2 )  { page = 1 ;  }


     /////////////////////Reset////////////////////

   if ( page == 1 && menuitem == 8 ) { resetFunc(); }// Reset
    
   } /////////////////////Reset////////////////////


   ////////////////////scren Rotation//////////////

    if (page == 1 && menuitem == 4 ) // scren Rotation 
    {        
            if ( selectedrotate == 1 )
        {
        rotated   = 1 ;
        menuItem4 = "rotate: 1" ;
        display.setRotation( rotated );
        }

       else if ( selectedrotate == 2 ) 
        {
        rotated   = 2 ;
        menuItem4 = "rotate: 2" ;
        display.setRotation( rotated );
        }

       else if ( selectedrotate == 3 ) 
        {
        rotated   = 3 ;
        menuItem4 = "rotate: 3" ;
        display.setRotation( rotated ) ;
        }

       else 
        {
        selectedrotate == 4 ; 
        rotated   = 4 ;
        menuItem4 = "rotate: 4" ;
        display.setRotation( rotated ) ;
        }   
    }/////////////scren Rotation/////////////////// 
    
  }
  
  //////////////////////loop//////////////////////////
  
 void drawMenu()
  {    
         if (page == 1) 
  {    
    display.setTextSize(1);
    display.clearDisplay();
    display.setTextColor(BLACK, WHITE);
    display.setCursor(21, 0);
    display.print("B  M  O");
    display.drawFastHLine(0,10,84,BLACK);

         if(menuitem == 1 && frame == 1)
    {   
      displayMenuItem(menuItem1, 15, true);
      displayMenuItem(menuItem2, 25,false);
      displayMenuItem(menuItem3, 35,false);
    }

    else if(menuitem == 2 && frame == 1)
    {
      displayMenuItem(menuItem1, 15,false);
      displayMenuItem(menuItem2, 25, true);
      displayMenuItem(menuItem3, 35,false);
    }

    else if(menuitem == 3 && frame == 1)
    {
      displayMenuItem(menuItem1, 15,false);
      displayMenuItem(menuItem2, 25,false);
      displayMenuItem(menuItem3, 35, true);
    }

    else if(menuitem == 4 && frame == 2)
    {
      displayMenuItem(menuItem2, 15,false);
      displayMenuItem(menuItem3, 25,false);
      displayMenuItem(menuItem4, 35, true);
    }

    else if(menuitem == 3 && frame == 2)
    {
      displayMenuItem(menuItem2, 15,false);
      displayMenuItem(menuItem3, 25, true);
      displayMenuItem(menuItem4, 35,false);
    }

    else if(menuitem == 2 && frame == 2)
    {
      displayMenuItem(menuItem2, 15, true);
      displayMenuItem(menuItem3, 25,false);
      displayMenuItem(menuItem4, 35,false);
    }
    
    else if(menuitem == 5 && frame == 3)
    {
      displayMenuItem(menuItem3, 15,false);
      displayMenuItem(menuItem4, 25,false);
      displayMenuItem(menuItem5, 35, true);
    }

    else if(menuitem == 6 && frame == 4)
    {
      displayMenuItem(menuItem4, 15,false);
      displayMenuItem(menuItem5, 25,false);
      displayMenuItem(menuItem6, 35, true);
    }
    
    else if(menuitem == 5 && frame == 4)
    {
      displayMenuItem(menuItem4, 15,false);
      displayMenuItem(menuItem5, 25, true);
      displayMenuItem(menuItem6, 35,false);
    }

    else if(menuitem == 4 && frame == 4)
    {
      displayMenuItem(menuItem4, 15, true);
      displayMenuItem(menuItem5, 25,false);
      displayMenuItem(menuItem6, 35,false);
    }

    else if(menuitem == 3 && frame == 3)
    {
      displayMenuItem(menuItem3, 15, true);
      displayMenuItem(menuItem4, 25,false);
      displayMenuItem(menuItem5, 35,false);
    }

    else if(menuitem == 2 && frame == 2)
    {
      displayMenuItem(menuItem2, 15, true);
      displayMenuItem(menuItem3, 25,false);
      displayMenuItem(menuItem4, 35,false);
    }

    else if(menuitem == 4 && frame == 3)
    {
      displayMenuItem(menuItem3, 15,false);
      displayMenuItem(menuItem4, 25, true);
      displayMenuItem(menuItem5, 35,false);
    }

    else  if(menuitem==5 && frame == 5)//
    {   
      displayMenuItem(menuItem5, 15, true);
      displayMenuItem(menuItem6, 25,false);
      displayMenuItem(menuItem7, 35,false);
    }

    else if(menuitem == 6 && frame == 5)
    {
      displayMenuItem(menuItem5, 15,false);
      displayMenuItem(menuItem6, 25, true);
      displayMenuItem(menuItem7, 35,false);
    }

    else if(menuitem == 7 && frame == 5)
    {
      displayMenuItem(menuItem5, 15,false);
      displayMenuItem(menuItem6, 25,false);
      displayMenuItem(menuItem7, 35, true);
    }

    else  if(menuitem ==6 && frame == 6)//
    {   
      displayMenuItem(menuItem6, 15, true);
      displayMenuItem(menuItem7, 25,false);
      displayMenuItem(menuItem8, 35,false);
    }

    else if(menuitem == 7 && frame == 6)
    {
      displayMenuItem(menuItem6, 15,false);
      displayMenuItem(menuItem7, 25, true);
      displayMenuItem(menuItem8, 35,false);
    }

    else if(menuitem == 8 && frame == 6)
    {
      displayMenuItem(menuItem6, 15,false);
      displayMenuItem(menuItem7, 25,false);
      displayMenuItem(menuItem8, 35, true);
    }

    else  if(menuitem == 7 && frame == 7)//
    {   
      displayMenuItem(menuItem7, 15, true);
      displayMenuItem(menuItem8, 25,false);
      displayMenuItem(menuItem9, 35,false);
    }

    else if(menuitem == 8 && frame == 7)
    {
      displayMenuItem(menuItem7, 15,false);
      displayMenuItem(menuItem8, 25, true);
      displayMenuItem(menuItem9, 35,false);
    }

    else if(menuitem == 9 && frame == 7)
    {
      displayMenuItem(menuItem7, 15,false);
      displayMenuItem(menuItem8, 25,false);
      displayMenuItem(menuItem9, 35, true);
    } 
    else  if(menuitem == 8 && frame == 8)//
    {   
      displayMenuItem(menuItem8,  15, true);
      displayMenuItem(menuItem9,  25,false);
      displayMenuItem(menuItem10, 35,false);
    }

    else if(menuitem == 9 && frame == 8)
    {
      displayMenuItem(menuItem8,  15,false);
      displayMenuItem(menuItem9,  25, true);
      displayMenuItem(menuItem10, 35,false);
    }

    else if(menuitem == 10 && frame == 8)
    {
      displayMenuItem(menuItem8,  15,false);
      displayMenuItem(menuItem9,  25,false);
      displayMenuItem(menuItem10, 35, true);
    } 
    display.display();
  }
////////////////////////////////////////////////////////////////////// 

  else if (page == 2 && menuitem == 1 )  { displayIntMenuPage(menuItem1, contrast); } //TIME//

  else if (page == 2 && menuitem == 2 ) //3DCUBE//
  {
     drawCube();
    // delay(ROTATION_SPEED);
	   if ( timeMillis - time3 >= timeCube )
      {	time3 == timeMillis ;
      ROTATION_SPEED;
       }
   }

  else if (page == 2 && menuitem == 3 )  { displayStringMenuPage(menuItem3, MOOD[selectedMOOD]); }//MOOD//

  else if (page == 2 && menuitem == 4 )  { displayStringMenuPage(menuItem4, rotate[selectedrotate]); }//ROTATE//

  else if (page == 2 && menuitem == 5 )  { menuItem5, wheel();}//WHEEL//

  else if (page == 2 && menuitem == 6 )  { menuItem6, imege1();}//IMEGE//

  else if (page == 2 && menuitem == 7 )  { menuItem7, HC_SR04();}//HCSR04//

  }
 
  //////////////////////drawMenu//////////////////////


void setContrast()
  {
    display.setContrast(contrast);
    display.display();
  }
  
  /////////////////////setContrast////////////////////

void timerIsr() { encoder -> service() ; }

/////////////////////////timerIsr/////////////////////

void displayIntMenuPage(String menuItem, int value)
{
    display.setTextSize(1);
    display.clearDisplay();
    display.setTextColor(BLACK, WHITE);
    display.setCursor(15, 0);
    display.print(menuItem);
    display.drawFastHLine(0,10,83,BLACK);
    display.setCursor(1, 12);
    display.print("      ");
    display.setTextSize(2);
    display.setCursor(5, 25);
    display.print(value);
    display.setTextSize(2);
    display.display();
}

////////////////////displayIntMenuPage////////////////

void displayStringMenuPage(String menuItem, String value)
{
    display.setTextSize(1);
    display.clearDisplay();
    display.setTextColor(BLACK, WHITE);
    display.setCursor(15, 0);
    display.print(menuItem);
    display.drawFastHLine(0,10,83,BLACK);
    display.setCursor(5, 15);
    display.print("    ");
    display.setTextSize(2);
    display.setCursor(5, 25);
    display.print(value);
    display.setTextSize(2);
    display.display();
}

////////////////////displayStringMenuPage/////////////

void displayMenuItem(String item, int position, boolean selected)
{
    if(selected) { display.setTextColor (WHITE, BLACK); }

    else { display.setTextColor (BLACK, WHITE); }

    display.setCursor(0, position);
    display.print(">" + item);
}

///////////////////////displayMenuItem////////////////

void readRotaryEncoder()
{
      //  if ( timeMillis - time2 >= timeEncoder ) 
      //  {	time2 == timeMillis ;}
  value += encoder -> getValue();
       
       if (value / 2 > last)
  {

    last = value / 2;
    down = true;

       
  }
  
  else if (value / 2 < last)
  {

    last = value / 2;
    up   = true;
  } 
      //  if ( timeMillis - time2 >= timeEncoder ) 
      //  {	time2 == timeMillis ;}
}

/////////////////////readRotaryEncoder////////////////

void drawCube() 
 {
      r[0]  =  r[0] + PI / 180.0; // Add a degree
      r[1]  =  r[1] + PI / 180.0; // Add a degree
      r[2]  =  r[2] + PI / 180.0; // Add a degree
  if (r[0] >= 360.0 * PI / 180.0 ) r[0] = 0;
  if (r[1] >= 360.0 * PI / 180.0 ) r[1] = 0;
  if (r[2] >= 360.0 * PI / 180.0 ) r[2] = 0;

    for (int i = 0; i < 8; i++) 
    {
    float px2 = 		         px[i] ;
    float py2 =  cos(r[0]) * py[i] - sin(r[0]) * pz[i];
    float pz2 =  sin(r[0]) * py[i] + cos(r[0]) * pz[i];
    float px3 =  cos(r[1]) * px2   + sin(r[1]) * pz2;
    float py3 =  			       py2;
    float pz3 = -sin(r[1]) * px2   + cos(r[1]) * pz2;
    float ax  =  cos(r[2]) * px3   - sin(r[2]) * py3;
    float ay  =  sin(r[2]) * px3   + cos(r[2]) * py3;
    float az  = 		         pz3   - 150;

    p2x[i] = LCDWIDTH  / 2 + ax * SHAPE_SIZE / az;
    p2y[i] = LCDHEIGHT / 2 + ay * SHAPE_SIZE / az;
   }

    display.clearDisplay();

  for (int i = 0 ; i < 3 ; i++ ) 
  {
    display.drawLine(p2x[i],   p2y[i],   p2x[i+1], p2y[i+1], BLACK);
    display.drawLine(p2x[i+4], p2y[i+4], p2x[i+5], p2y[i+5], BLACK);
    display.drawLine(p2x[i],   p2y[i],   p2x[i+4], p2y[i+4], BLACK);
  }
    display.drawLine(p2x[3],   p2y[3],   p2x[0],   p2y[0],   BLACK);
    display.drawLine(p2x[7],   p2y[7],   p2x[4],   p2y[4],   BLACK);
    display.drawLine(p2x[3],   p2y[3],   p2x[7],   p2y[7],   BLACK);
  
    display.display();
}

/////////////////////////3d_cube//////////////////////

void HC_SR04()
 {
   display.setTextColor(BLACK, WHITE);

//   if ( timeMillis - time4 >= timeHCSR04ms2 )
//         {	
// 		time4 == timeMillis ;
// 		   }

  digitalWrite(trigPin, LOW);	
  delayMicroseconds(5);

//   if ( timeMillis - time5 >= timeHCSR04ms10 )
//         {	
// 		time5 == timeMillis ;
// 		}

  digitalWrite(trigPin, HIGH);	
  delayMicroseconds(10);

  digitalWrite(trigPin, LOW);
  pinMode(echoPin, INPUT);
  duration = pulseIn(echoPin, HIGH);
  cm     = (duration/2) / 29.1;     // Divide by 29.1 or multiply by 0.0343
  inches = (duration/2) / 74;   // Divide by 74 or multiply by 0.0135
  display.clearDisplay();


  if ( timeMillis - time1 >= timeHCSR04 )
      {	 time1 == timeMillis ; }
  if (cm > max_ring)
  {
    display.setTextSize(0);    
    display.setCursor(6, 20);
    display.print("out of range");
  }

  else
  {
  display.setTextSize(2);
  display.setCursor(10, 20);
  display.print(cm);
  display.setCursor(55, 20);
  display.print("cm");
  // display.setCursor(10, 40);
  // display.print(inches);
  // display.setCursor(30, 20);
  // display.print("in");
  }

  display.display();
  delay(250);
      
      
}

/////////////////////////HC_SR0///////////////////////

void imege1()
{

  display.clearDisplay();
  display.drawBitmap(0, 0,  aq, 84, 48, 1);
  display.display();
}
void imege2()
{

  display.clearDisplay();
  display.drawBitmap(0, 0,  DNR, 84, 48, 1);
  display.display();
}

//////////////////////////imege///////////////////////

void time()
{
  
//   if ( timeMillis - time5 >= timeHCSR04ms10 )
//         {	
// 		time5 == timeMillis ;
// 		}
  display.setCursor(10, 20);
 // display.print("timeMillis");
  display.display();

}

//////////////////////////time////////////////////////

void wheel()
{                           
                             
    distance = ((2*pi*R)/N) * Pos ;
    display.setTextColor(BLACK, WHITE);
    display.setTextSize(2);
    display.setCursor(10, 15);
    display.print( distance);

    display.setTextSize(1);
    display.setCursor(20, 1);
    display.print("cm  ");

    display.display();
    display.clearDisplay();
    LastState = State;
      
}

//////////////////////////wheel////////////////////////


